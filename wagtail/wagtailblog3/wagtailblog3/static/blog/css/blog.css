/* wagtailblog3/static/blog/css/blog.css */

/* --- Hero 区域 --- */
.blog-hero {
    position: relative;
    background: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%);
    color: white;
    padding: 5rem 0;
    margin-bottom: 2rem;
    overflow: hidden;
}
.blog-hero::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 0, 0, 0.4); z-index: 1;
}
.blog-hero-content { position: relative; z-index: 2; text-align: center; }
.blog-title {
    font-size: 3.2rem; margin-bottom: 1.5rem; font-weight: 700;
    text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.6);
    font-family: 'Playfair Display', serif;
}
.blog-meta {
    display: flex; justify-content: center; align-items: center; gap: 2rem;
    margin-top: 1.5rem; font-size: 1.1rem; opacity: 0.9;
}
.blog-meta i { margin-right: 5px; color: #ffd700; }
.blog-intro {
    font-size: 1.2rem; margin: 1.5rem auto; max-width: 900px;
    line-height: 1.6; opacity: 0.95;
}
.blog-featured-image {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    object-fit: cover; z-index: 0;
}
.hero-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

/* --- 布局容器 --- */
.full-width-container {
    max-width: 95%; width: 1800px; margin: 0 auto; padding: 0 15px;
}
.blog-layout-container {
    display: flex; gap: 30px; align-items: flex-start; margin-bottom: 3rem; position: relative;
}

/* --- 左侧 TOC 侧边栏 --- */
.blog-sidebar-left {
    width: 260px;
    flex-shrink: 0;
    position: sticky;
    top: 20px;
    z-index: 10;
}

.toc-wrapper {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    padding: 15px 10px;
    max-height: 85vh;
    overflow-y: auto;
}

.toc-header {
    font-size: 14px;
    font-weight: 600;
    color: #999;
    text-transform: uppercase;
    margin-bottom: 10px;
    padding-left: 10px;
}

/* ★★★ Typora 风格 TOC 样式核心 (已优化换行) ★★★ */
.toc-list, .toc-sub-menu {
    list-style: none; padding: 0; margin: 0;
}
.toc-sub-menu {
    padding-left: 16px;
    display: block;
    border-left: 1px solid #f0f0f0;
    margin-left: 7px;
}

/* TOC 行容器：Flex 布局 */
.toc-entry {
    display: flex;
    /* 改动 1：改为顶部对齐，防止文字换行后三角位置尴尬 */
    align-items: flex-start;
    padding: 2px 0;
    border-radius: 4px;
    transition: background-color 0.2s;
}
.toc-entry:hover {
    background-color: #f5f5f5;
}

/* 三角开关 */
.toc-toggle {
    width: 20px;
    height: 24px; /* 固定高度 */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #999;
    font-size: 12px;
    flex-shrink: 0;
    transition: transform 0.2s ease, color 0.2s;
    /* 改动 2：加一点顶部外边距，让它对齐第一行文字 */
    margin-top: 2px;
}
.toc-toggle:hover { color: #333; }
.toc-toggle.placeholder { cursor: default; opacity: 0; }

/* 文字链接 */
.toc-link {
    flex-grow: 1;
    display: block;
    padding: 4px 8px 4px 2px;
    color: #555;
    text-decoration: none;
    font-size: 14px;
    line-height: 1.5; /* 增加一点行高，多行阅读更舒服 */
    cursor: pointer;
    border-left: 3px solid transparent;

    /* ★★★ 改动 3：允许换行，这是核心修改 ★★★ */
    white-space: normal; /* 允许文字换行 */
    word-break: break-word; /* 防止长单词(如英文标题)撑破容器 */
    overflow: visible; /* 显示所有内容 */
    text-overflow: clip; /* 去掉省略号 */
}

/* 不同层级的缩进 (保持不变) */
.toc-link.level-1 { padding-left: 10px; font-weight: 600; color: #333; }
.toc-link.level-2 { padding-left: 25px; }
.toc-link.level-3 { padding-left: 40px; font-size: 13px; }
.toc-link.level-4 { padding-left: 55px; font-size: 13px; }

.toc-link:hover {
    background-color: #f5f7fa;
    color: #007bff;
}

/* 激活状态 */
.toc-link.active {
    color: #007bff;
    font-weight: 600;
    background-color: #e8f0fe;
    border-left-color: #007bff;
}
.toc-item.active > .toc-entry {
    background-color: #e8f0fe;
}

/* 折叠状态逻辑 */
.toc-item.collapsed > .toc-sub-menu {
    display: none;
}
.toc-item.collapsed > .toc-entry .toc-toggle i {
    transform: rotate(-90deg);
}
.toc-toggle i {
    transition: transform 0.2s ease;
    transform: rotate(0deg);
}

/* --- 中间内容 --- */
.blog-center-column {
    flex-grow: 1; min-width: 0;
    background: white; border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    overflow: hidden;
}
.article-scroll-container {
    height: 80vh; overflow-y: auto;
    padding: 40px 50px; position: relative; scroll-behavior: smooth;
    max-height: none !important;
}
.article-body-content { background: transparent; }
/* 滚动条 */
.article-scroll-container::-webkit-scrollbar { width: 6px; }
.article-scroll-container::-webkit-scrollbar-track { background: #f1f1f1; }
.article-scroll-container::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 3px; }
.article-scroll-container::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
/* 评论区 */
.blog-comments-section {
    border-top: 1px solid #eee; padding: 30px 50px; background: #fafafa;
}

/* --- 右侧侧边栏 --- */
.blog-sidebar-right { width: 300px; flex-shrink: 0; position: sticky; top: 20px; }
.sidebar-widget {
    background: #fff; border: 1px solid #eee; border-radius: 8px; padding: 20px; margin-bottom: 20px;
}
.widget-title {
    font-size: 16px; font-weight: 700; color: #333;
    margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #f0f0f0;
}
/* 右侧列表 */
.related-list { display: flex; flex-direction: column; gap: 15px; }
.related-item-small { display: flex; gap: 12px; text-decoration: none; align-items: flex-start; }
.related-thumb {
    width: 60px; height: 60px; flex-shrink: 0; border-radius: 4px; overflow: hidden;
    background: #eee; display: flex; align-items: center; justify-content: center;
}
.related-thumb img { width: 100%; height: 100%; object-fit: cover; }
.related-info h5 {
    font-size: 14px; margin: 0 0 5px 0; line-height: 1.4; color: #333;
    display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
}
.related-info .date { font-size: 12px; color: #999; }
.related-item-small:hover h5 { color: #007bff; }
.nav-widget { display: flex; flex-direction: column; gap: 10px; }
.nav-btn {
    display: block; padding: 12px; background: #f8f9fa; border-radius: 6px;
    text-decoration: none; border: 1px solid #eee; transition: all 0.2s;
}
.nav-btn:hover { background: #fff; border-color: #007bff; box-shadow: 0 2px 8px rgba(0,123,255,0.1); }
.nav-btn .label { display: block; font-size: 12px; color: #888; margin-bottom: 4px; }
.nav-btn .title { display: block; font-size: 14px; font-weight: 600; color: #333; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
/* --- 修复：文章反应按钮样式 --- */
.reaction-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.reaction-btn {
    flex: 1 1 45%; /* 一行两个 */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 10px;
    font-size: 14px;
    border: 1px solid #eee;
    background-color: #f9f9f9;
    color: #666;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    /* 禁用浏览器默认按钮样式 */
    outline: none;
    box-shadow: none;
}

.reaction-btn i {
    font-size: 16px;
    color: #888;
    transition: color 0.2s;
}

.reaction-btn:hover {
    background-color: #f0f0f0;
    border-color: #ddd;
    transform: translateY(-2px); /* 轻微上浮 */
}

/* ★★★ 关键修复：激活状态样式 ★★★ */
.reaction-btn.active {
    background-color: #e8f0fe; /* 浅蓝色背景 */
    border-color: #007bff;     /* 蓝色边框 */
    color: #007bff;            /* 蓝色文字 */
    font-weight: 600;
}

.reaction-btn.active i {
    color: #007bff; /* 图标也变蓝 */
    animation: bounce 0.4s ease; /* 加个小动画 */
}

/* 点赞动画 */
@keyframes bounce {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
}

/* --- 响应式 --- */
@media (max-width: 1100px) {
    .blog-layout-container { flex-direction: column; }
    .blog-sidebar-left, .blog-sidebar-right { display: none; }
    .blog-center-column { width: 100%; border-radius: 0; box-shadow: none; background: transparent; }
    .article-scroll-container { height: auto !important; overflow-y: visible !important; padding: 0; }
    .article-body-content { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    #mobile-interactions-placeholder { margin-top: 30px; }
    .blog-comments-section { margin-top: 30px; border-radius: 8px; }
}

/* --- 三栏拖动布局系统 (PC端生效) --- */
@media (min-width: 992px) {
    .resizable-layout-container {
        display: flex;
        width: 100%;
        max-width: 1400px; /* 限制最大宽度，防止在大屏太散 */
        margin: 0 auto;
        padding: 0 15px;
        align-items: flex-start; /* 顶部对齐 */
        position: relative;
    }

    .layout-column {
        padding: 20px;
        /* 防止内容溢出撑破布局 */
        overflow-x: hidden;
    }

    .sidebar-content.sticky-top-content {
        position: sticky;
        top: 80px; /* 假设你的顶部导航栏高度约60-80px */
        max-height: calc(100vh - 100px);
        overflow-y: auto;
        /* 美化滚动条 */
        scrollbar-width: thin;
    }

    /* 中间文章区域 */
    .main-content {
        background: #fff;
        min-height: 800px;
        box-shadow: 0 0 15px rgba(0,0,0,0.02);
    }
}

/* --- 移动端适配 (小于992px时强制还原) --- */
@media (max-width: 991px) {
    .resizable-layout-container {
        display: block; /* 恢复为垂直堆叠 */
    }

    .layout-column {
        width: 100% !important; /* 强制全宽 */
        padding: 15px 0;
    }

    .resizer {
        display: none !important; /* 隐藏拖动条 */
    }

    .left-sidebar, .right-sidebar {
        border-bottom: 1px solid #eee;
        margin-bottom: 20px;
    }

    .restore-btn, .sidebar-toggle-btn {
        display: none !important; /* 移动端不显示折叠按钮 */
    }
}

