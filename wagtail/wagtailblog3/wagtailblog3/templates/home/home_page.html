{# templates/home/home_page.html #}

{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags blog_tags static archive_tags  %} {# æ–°å¢ archive_tags #}

{% block body_class %}home-page{% endblock %}

{% block content %}
<!--è·å–homepageç›®å½•ä¸‹çš„BlogIndexPageå¹¶æ¸²æŸ“è½®æ’­-->
<section class="main-slider style-two">
    <div class="auto-container">

        {#  è·å–BlogIndexPageçš„æ‰€æœ‰å®ä¾‹ï¼Œè½®æ’­ #}
        <div class="single-item-carousel owl-carousel owl-theme">
            {% if blog_indexs %}
                {% for blog_index in blog_indexs %}
                <!--Slide-->
                <div class="slide">
                    <figure class="image">
                        {% if blog_index.featured_image %}
                            {% image blog_index.featured_image fill-800x400 alt=blog_index.title %}
                        {% else %}
                            <img src="{% static 'gretzia/images/resource/slide-1.jpg' %}" alt="{{ blog_index.title }}" />
                        {% endif %}
                    </figure>
                    <div class="overlay-box">
                        <div class="overlay-inner">
                            <div class="content">
                                <div class="title">
                                    <a href="{% pageurl blog_index %}" class="badge badge-primary">åšå®¢ä¸“æ </a>
                                </div>
                                <h2>
                                    <a href="{% pageurl blog_index %}">{{ blog_index.title }}</a>
                                </h2>
                                <div class="text">
                                    {% if blog_index.intro %}
                                        {{ blog_index.intro|richtext|striptags|truncatechars:100 }}
                                    {% else %}
                                        æ¢ç´¢ {{ blog_index.title }} ä¸­çš„ç²¾å½©å†…å®¹
                                    {% endif %}
                                </div>
                                <a href="{% pageurl blog_index %}" class="theme-btn btn-style-one">é˜…è¯»å…¨æ–‡</a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</section>


<div class="sidebar-page-container">
    <div class="auto-container">
        <div class="row clearfix">

            <!--å†…å®¹-->
            <div class="content-side col-lg-8 col-md-8 col-sm-12 col-xs-12">

                <div class="content-inner">

                    <!--ä¸»é¡µæ ‡é¢˜-->
                    <div class="sec-title">
                        <h2>{{ page.title }}</h2>
                        <div class="post-date">{{ page.date }}</div>
                    </div>

                    <!--ä¸»é¡µè¯¦æƒ…é¡µ-->
                    <div class="news-detail">
                        <div class="inner-box">
                            <div class="single-item-carousel owl-carousel owl-theme">
                                <div class="image">
                                    {% if page.banner_image %}
                                        {# æ€§èƒ½ä¼˜åŒ–: ä½¿ç”¨ webp #}
                                        {% image page.banner_image fill-1200x400 format-webp as banner_img %}
                                        <img src="{{ banner_img.url }}" alt="{{ page.title }}" class="img-fluid rounded" />
                                    {% else %}
                                        <img src="{% static 'gretzia/images/resource/news-6.jpg' %}" alt="{{ page.title }}" class="img-fluid rounded" />
                                    {% endif %}
                                </div>
                            </div>
                            <div class="fullwidth-content">
                                <div class="text">
                                    {# æ˜¾ç¤ºä¸»é¡µä¸ªäººæ–‡æœ¬ #}
                                    {% if page.hero_text %}
                                        <p class="hero-text">{{ page.hero_text }}</p>
                                    {% endif %}
                                    <blockquote>
                                        {# æ˜¾ç¤º CTA æŒ‰é’®æˆ–é“¾æ¥ #}
                                        {% if page.hero_cta_link %}
                                            <a href="{% pageurl page.hero_cta_link %}" class="button hero-cta">
                                                {# ä½¿ç”¨ firstof æ¥æ˜¾ç¤º hero_cta æ–‡æœ¬ï¼Œå¦‚æœä¸ºç©ºåˆ™æ˜¾ç¤ºé“¾æ¥é¡µé¢çš„æ ‡é¢˜ #}
                                                {% firstof page.hero_cta page.hero_cta_link.title %}
                                            </a>
                                        {% elif page.hero_cta %}
                                            {# å¦‚æœæ²¡æœ‰é“¾æ¥é¡µé¢ï¼Œä½†æœ‰ CTA æ–‡æœ¬ï¼Œå¯ä»¥è€ƒè™‘åªæ˜¾ç¤ºæ–‡æœ¬æˆ–è€…ç¦ç”¨æŒ‰é’® #}
                                             <span class="button hero-cta disabled">{{ page.hero_cta }}</span>
                                        {% endif %}
                                    </blockquote>
                                    <p>{{ page.body| richtext }} {# æ˜¾ç¤ºâ€œç®€ä»‹â€å’Œâ€œä¸ªäººç®€ä»‹â€å†…å®¹ #} </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="sec-title">
                        <h2>ğŸ”¥ çƒ­é—¨é˜…è¯»</h2>
                        <div class="separator"></div>
                    </div>
                    {% if popular_posts %} {# å¦‚æœæœ‰æœ€çƒ­çš„åšå®¢æ–‡ç«  #}
                    <div class="masonry-items-container row clearfix">

                        {% for post in popular_posts %} {# éå†æœ€çƒ­çš„åšå®¢æ–‡ç«  #}
                        <!--News Block Two-->
                        <div class="news-block-two masonry-item col-md-6 col-sm-6 col-xs-12">
                            <div class="inner-box">
                                <div class="image">
                                    {% if post.featured_image %}
                                        {# æ€§èƒ½ä¼˜åŒ–: è¿™é‡Œçš„å›¾ç‰‡åœ¨é¦–å±ä¸‹æ–¹ï¼Œå¿…é¡»å¼€å¯ lazy loading #}
                                        {% image post.featured_image fill-400x300 format-webp as post_img %}
                                        <img src="{{ post_img.url }}"
                                             alt="{{ post.title }}"
                                             loading="lazy"
                                             width="{{ post_img.width }}"
                                             height="{{ post_img.height }}"
                                             class="transition-image" />
                                    {% else %}
                                        <img src="{% static 'gretzia/images/resource/news-7.jpg' %}" alt="{{ post.title }}" loading="lazy" />
                                    {% endif %}
                                </div>
                                <div class="lower-content">
                                    {# æ˜¾ç¤ºæ–‡ç« åˆ†ç±»ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ #}
                                    {% if post.categories.first %}
                                        <div class="title">
                                            <a href="{% pageurl post %}">{{ post.categories.first.name }}</a>
                                        </div>
                                    {% else %}
                                        <div class="title">
                                            <a href="{% pageurl post %}">åšå®¢</a>
                                        </div>
                                    {% endif %}

                                    <h2><a href="{% pageurl post %}">{{ post.title }}</a></h2>

                                    <div class="post-date">{{ post.date|date:"F d, Y" }}</div>

                                    {# æ˜¾ç¤ºæ–‡ç« ç®€ä»‹ #}
                                    <div class="text">
                                        {% if post.intro %}
                                            {{ post.intro|striptags|truncatechars:60 }}
                                        {% else %}
                                            {{ post.title }} - ç‚¹å‡»é˜…è¯»æ›´å¤šç²¾å½©å†…å®¹...
                                        {% endif %}
                                    </div>

                                    {# æ˜¾ç¤ºè®¿é—®ç»Ÿè®¡å’Œååº” #}
                                    {% with view_counts=post.get_view_count reactions=post.get_reactions %}
                                        {% if view_counts or reactions %}
                                            <div class="post-stats" style="margin: 15px 0; font-size: 13px; color: #888; border-top: 1px solid #eee; padding-top: 15px;">
                                                {% if view_counts %}
                                                    <span style="margin-right: 20px;">
                                                        <i class="fa fa-eye"></i> {{ view_counts.total }} æ¬¡æµè§ˆ
                                                    </span>
                                                {% endif %}
                                                {% if reactions %}
                                                    <span>
                                                        <i class="fa fa-heart"></i>
                                                        {% for reaction in reactions %}
                                                            {{ reaction.icon }} {{ reaction.count }}
                                                        {% endfor %}
                                                    </span>
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                    {% endwith %}

                                    <div class="btn-box text-center">
                                        <a href="{% pageurl post %}" class="theme-btn btn-style-two">é˜…è¯»æ›´å¤š</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}

                </div>
            </div>

            {# æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å…¶ä»–åŒºå—ï¼Œä¾‹å¦‚æ ‡ç­¾ç­‰ #}
            <div class="sidebar-side col-lg-4 col-md-4 col-sm-12 col-xs-12">
                    <aside class="sidebar sticky-top">

                         {# æ£€æŸ¥æ˜¯å¦å­˜åœ¨éšæœºä½œè€… #}
                        <div class="sidebar-widget about-widget">
                            {% random_author_sidebar %}
                            </div>


                    	<!-- æ ‡ç­¾è¾¹æ¡†ï¼šè·å–è¢«æ–‡ç« è¿ç”¨æœ€å¤šçš„å‰6åæ ‡ç­¾ -->
                        <div class="sidebar-widget category-widget">
                            {% top_tags_sidebar %} {# è¿™æ˜¯æ–°çš„æ ‡ç­¾ #}
                        </div>

                        {# --- æ–°å¢ï¼šæ–‡ç« å½’æ¡£ --- #}
                        <div class="sidebar-widget category-widget">
                            <h2>æ–‡ç« å½’æ¡£</h2>
                            {% archive_sidebar %}
                        </div>
                        {# --- æ–‡ç« å½’æ¡£ç»“æŸ --- #}

                    </aside>
                </div>

        </div>
    </div>
</div>
{% endblock %}
